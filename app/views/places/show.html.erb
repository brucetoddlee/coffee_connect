

 <script src="http://speedof.me/api/api.js" type="text/javascript"></script> 
 
<h2>SpeedOf.Me Speed Test</h2> 
<button id="btnStart" type="button" onclick="btnStartClick()"><h3>Start Test</h3></button> 
<div id="msg"></div> 

<script type="text/javascript"> 
 SomApi.account = "SOM52ef3fd308dbe"; //your API Key here 
 SomApi.domainName = "coffeeconnect.herokuapp.com"; //your domain or sub-domain here 
 SomApi.config.sustainTime = 4; 
 SomApi.onTestCompleted = onTestCompleted; 
 SomApi.onError = onError; 
 
 var msgDiv = document.getElementById("msg"); 
 
 function btnStartClick() { 
 msgDiv.innerHTML = "<h3>Speed test in progress. Please wait...</h3>"; 
 SomApi.startTest(); 
 } 
 




function fieldFor($form, name, key, val) {
	var formField = "<input type='hidden' name='"+name+"['"+key+"]' value='"+val+"'>"
	$form.append(formField)
	return $form;
}

function formFor(action, method, name, data){
	var $form = $("<form id='new_"+name+"' action='"+action+"' method='"+method+"'></form>")
	$.each(data, function(key, val){
		$form = fieldFor($form, name, data)
	})

	return $form;
}

function setupHiddenForm(testResult, con_id) {
	$form = formFor(window.location.pathname, "post", "test", testResult);
	$form.append("<button>Save Result</button>");
	$(con_id).append($form);
}


 function onTestCompleted(testResult) { 
 
 setupHiddenForm(testResult, "#msg");

 msgDiv.innerHTML = 
 "<h3>"+ 
 "Download: " +testResult.download +"Mbps <br/>"+ 
 "Upload: " +testResult.upload +"Mbps <br/>"+ 
 "Latency: " +testResult.latency +"ms <br/>"+ 
 "Jitter: " +testResult.jitter +"ms <br/>"+ 
 "Test Server: "+testResult.testServer +"<br/>"+ 
 "IP: " +testResult.ip_address +"<br/>"+ 
 "Hostname: " +testResult.hostname +"<br/>"+ 
 "</h3>"; 
 } 
 
 function onError(error) { 
 msgDiv.innerHTML = "Error "+ error.code + ": "+error.message; 
 } 
</script> 



<div class = "container">

<h2><%= @place["name"] %> Details</h2></br>

<img src="<%= @place["image_url"] %>"></br>

<img src="<%= @place["rating_img_url"] %>"></br>
<%= @place["review_count"] %> Yelp reviews</br>
</br>

<% @place["location"]["display_address"].each do |line| %>
  <%= line %></br>
<%end%>

</br>


</div>